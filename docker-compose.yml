version: "3"
services:
  db:
    image: nouchka/sqlite3
  customers_backend:
    build: "./restaurant_customers_backend"
    command: bundle exec rackup --host '0.0.0.0' -p 3000
    ports:
      - "3000:3000"
    volumes:
      - .:/myapp/restaurant_customers_backend
    depends_on:
      - db  
  Customers_frontend:
    build: "./restaurant_customers"
    command:
      bundle exec rackup --host '0.0.0.0' -p 2000  
    ports:
      - "2000:2000"
    volumes:
      - ./restaurant_customers:/myapp/restaurant_customers   
    depends_on:
      - customer_backend
  staff_backend:
    build: "./restaurant_staff_backend"
    command: bundle exec shotgun --host '0.0.0.0' -p 4000
    ports:
      - "4000:4000" 
    volumes:
      - ./restaurant_staff_backend/deveopment.db:/myapp/restaurant_staff_backend/development.db
  staff_frontend:
    build: "./restaurant_staff"
    command:
      bundle exec rackup --host '0.0.0.0' -p 5000
    ports:
      - "5000:5000"   
    volumes:
      - ./restaurant_staff:/myapp/restaurant_staff
    depends_on:
      - staff_backend    
